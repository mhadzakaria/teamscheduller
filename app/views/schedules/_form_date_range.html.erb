  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <style>
    label, input { display:block; }
    input.text { margin-bottom:12px; width:95%; padding: .4em; }
    fieldset { padding:0; border:0; margin-top:25px; }
    h1 { font-size: 1.2em; margin: .6em 0; }
    div#users-contain { width: 350px; margin: 20px 0; }
    div#users-contain table { margin: 1em 0; border-collapse: collapse; width: 100%; }
    div#users-contain table td, div#users-contain table th { border: 1px solid #eee; padding: .6em 10px; text-align: left; }
    .ui-dialog .ui-state-error { padding: .3em; }
    .validateTips { border: 1px solid transparent; padding: 0.3em; }
  </style>
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script>
  $( function() {
    var dialog, form,
 
      // From http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#e-mail-state-%28type=email%29
      note = $( "#note" ),
      allFields = $( [] ).add( note );
  
    function saveNote() {
      var valid = true;
      allFields.removeClass( "ui-state-error" );

      if ( valid ) {
        $("#position").submit();
        dialog.dialog( "close" );
      }
      return valid;
    }
 
    dialog = $( "#dialog-form" ).dialog({
      autoOpen: false,
      height: 400,
      width: 350,
      modal: true,
      buttons: {
        "Save Note": saveNote,
        Cancel: function() {
          dialog.dialog( "close" );
        }
      },
      close: function() {
      }
    });
 
    $( "#print" ).button().on( "click", function() {
      dialog.dialog( "open" );
    });
  } );
  </script>
  <script>
  $( function() {
    var dateFormat = "yy-mm-dd",

      //TAMBAHAN AGAR CLIKC BISA TWICE
      // var b1 = $("#print-excel");
      // b1.click(function(){
      //     console.log('clicked', this.id)
      // })
      //TAMBAHAN AGAR CLIKC BISA TWICE

      from = $( "#from" )
        .datepicker({
          defaultDate: "+1w",
          changeMonth: true,
          numberOfMonths: 3,
          dateFormat: "yy-mm-dd"
        })
        .on( "change", function() {
          to.datepicker( "option", "minDate", getDate( this ) );
        }),
      to = $( "#to" ).datepicker({
        defaultDate: "+1w",
        changeMonth: true,
        numberOfMonths: 3,
        dateFormat: "yy-mm-dd"
      })
      .on( "change", function() {
        from.datepicker( "option", "maxDate", getDate( this ) );
      });
 
    function getDate( element ) {
      var date;
      try {
        date = $.datepicker.parseDate( dateFormat, element.value );
      } catch( error ) {
        date = null;
      }
 
      return date;
    }
  } );
  </script>
</head>

<div id="dialog-form" title="Create note">
  <%= form_for :range, url: export_schedules_path(format: :xlsx), html: {id: 'position', name: 'position'} do |f| %>
    <div class="form-group">
      <%= f.label :note %>
      <%= f.text_area :note, {class: 'form-control'}%><br>
    </div>
    <div class="form-group">
      <%= f.label :from , value: 'Tanggal' %>
      <%= f.text_field :from, {id: "from", placeholder: 'From', type: 'date', class: 'form-control'} %>
      <%= f.text_field :to, {id: "to", placeholder: 'To', type: 'date', class: 'form-control'} %>
    </div>
  <%end%>
</div>

<h2>Print Excel Report</h2>
<button id="print">Download Excel</button>
<br>